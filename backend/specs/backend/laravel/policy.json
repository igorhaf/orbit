{
  "id": "laravel-policy",
  "category": "backend",
  "name": "laravel",
  "spec_type": "policy",
  "title": "Authorization Policy",
  "description": "Laravel policy for model authorization",
  "content": "<?php\n\nnamespace App\\Policies;\n\nuse App\\Models\\User;\nuse App\\Models\\{ModelName};\n\nclass {ModelName}Policy\n{\n    public function viewAny(User $user): bool\n    {\n        return true;\n    }\n\n    public function view(User $user, {ModelName} ${model}): bool\n    {\n        return true;\n    }\n\n    public function create(User $user): bool\n    {\n        return $user->hasPermission('create_{model}');\n    }\n\n    public function update(User $user, {ModelName} ${model}): bool\n    {\n        return $user->id === ${model}->user_id\n            || $user->hasPermission('update_any_{model}');\n    }\n\n    public function delete(User $user, {ModelName} ${model}): bool\n    {\n        return $user->id === ${model}->user_id\n            || $user->hasPermission('delete_any_{model}');\n    }\n\n    public function restore(User $user, {ModelName} ${model}): bool\n    {\n        return $user->hasPermission('restore_{model}');\n    }\n\n    public function forceDelete(User $user, {ModelName} ${model}): bool\n    {\n        return $user->hasPermission('force_delete_{model}');\n    }\n}",
  "language": "php",
  "framework_version": null,
  "ignore_patterns": [
    "vendor/*"
  ],
  "file_extensions": [
    "php"
  ],
  "is_active": true,
  "metadata": {
    "created_at": "2025-12-29T09:58:45.175657Z",
    "updated_at": "2025-12-29T09:58:45.175657Z"
  }
}